{"dependencies":[{"name":"expo-router","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":60},"end":{"line":4,"column":36,"index":96}}],"key":"/+ErnBisjrT6aDU+GRp5Qz/lYoY=","exportNames":["*"],"imports":1}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":97},"end":{"line":5,"column":42,"index":139}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"../store/useUserStore","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":194},"end":{"line":7,"column":53,"index":247}}],"key":"5ijXyHjMlsfMZei+m4htNVv9OS4=","exportNames":["*"],"imports":1}},{"name":"../services/iap","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":8,"column":0,"index":248},"end":{"line":8,"column":45,"index":293}}],"key":"zOAPumWACsQPB7n8LLRKc7XVPSY=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/useColorScheme","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"gdN+P7eDH4evn7jZBGQVY+YTEvw=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/app/_layout.tsx\";\n  /**\n   * Root layout with navigation and onboarding check\n   */\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return RootLayout;\n    }\n  });\n  var _expoRouter = require(_dependencyMap[0], \"expo-router\");\n  var _react = require(_dependencyMap[1], \"react\");\n  var _storeUseUserStore = require(_dependencyMap[2], \"../store/useUserStore\");\n  var _servicesIap = require(_dependencyMap[3], \"../services/iap\");\n  var _reactNativeWebDistExportsUseColorScheme = require(_dependencyMap[4], \"react-native-web/dist/exports/useColorScheme\");\n  var useColorScheme = _interopDefault(_reactNativeWebDistExportsUseColorScheme);\n  var _reactJsxDevRuntime = require(_dependencyMap[5], \"react/jsx-dev-runtime\");\n  function RootLayout() {\n    const router = (0, _expoRouter.useRouter)();\n    const pathname = (0, _expoRouter.usePathname)();\n    const colorScheme = (0, useColorScheme.default)();\n    const {\n      onboardingCompleted,\n      getOriginalTransactionId,\n      needsServerValidation,\n      setSubscription\n    } = (0, _storeUseUserStore.useUserStore)();\n    const hasSyncedEntitlement = (0, _react.useRef)(false);\n    (0, _react.useEffect)(() => {\n      // Check onboarding status and redirect (but not if already on onboarding)\n      if (!onboardingCompleted && pathname !== '/onboarding') {\n        router.replace('/onboarding');\n      }\n    }, [onboardingCompleted, pathname]);\n    (0, _react.useEffect)(() => {\n      // Sync entitlement on launch (once per session)\n      if (hasSyncedEntitlement.current) return;\n      const syncEntitlement = async () => {\n        const originalTransactionId = getOriginalTransactionId();\n\n        // Sync if we have a transaction ID or need validation\n        if (originalTransactionId || needsServerValidation) {\n          hasSyncedEntitlement.current = true;\n          const state = await _servicesIap.iapService.syncEntitlementOnLaunch(originalTransactionId, needsServerValidation);\n          if (state) {\n            setSubscription(state);\n            console.log('âœ… [App] Entitlement synced on launch:', state.status);\n          }\n        }\n      };\n      syncEntitlement();\n    }, []);\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_expoRouter.Stack, {\n      screenOptions: {\n        headerShown: false,\n        contentStyle: {\n          backgroundColor: colorScheme === 'dark' ? '#0E1115' : '#F7F8FA'\n        }\n      },\n      children: [/*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_expoRouter.Stack.Screen, {\n        name: \"index\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 7\n      }, this), /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_expoRouter.Stack.Screen, {\n        name: \"onboarding\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 7\n      }, this), /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_expoRouter.Stack.Screen, {\n        name: \"chat/index\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 7\n      }, this), /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_expoRouter.Stack.Screen, {\n        name: \"passage/[ref]\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 7\n      }, this), /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_expoRouter.Stack.Screen, {\n        name: \"subscription\",\n        options: {\n          presentation: 'modal',\n          animation: 'slide_from_bottom'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 5\n    }, this);\n  }\n});","lineCount":112,"map":[[5,2,1,0],[6,0,2,0],[7,0,3,0],[8,2,1,0,"Object"],[8,8,1,0],[8,9,1,0,"defineProperty"],[8,23,1,0],[8,24,1,0,"exports"],[8,31,1,0],[9,4,1,0,"value"],[9,9,1,0],[10,2,1,0],[11,2,1,0],[11,11,1,0,"_interopDefault"],[11,27,1,0,"e"],[11,28,1,0],[12,4,1,0],[12,11,1,0,"e"],[12,12,1,0],[12,16,1,0,"e"],[12,17,1,0],[12,18,1,0,"__esModule"],[12,28,1,0],[12,31,1,0,"e"],[12,32,1,0],[13,6,1,0,"default"],[13,13,1,0],[13,15,1,0,"e"],[14,4,1,0],[15,2,1,0],[16,2,11,15,"Object"],[16,8,11,15],[16,9,11,15,"defineProperty"],[16,23,11,15],[16,24,11,15,"exports"],[16,31,11,15],[17,4,11,15,"enumerable"],[17,14,11,15],[18,4,11,15,"get"],[18,7,11,15],[18,18,11,15,"get"],[18,19,11,15],[19,6,11,15],[19,13,11,15,"RootLayout"],[19,23,11,15],[20,4,11,15],[21,2,11,15],[22,2,4,0],[22,6,4,0,"_expoRouter"],[22,17,4,0],[22,20,4,0,"require"],[22,27,4,0],[22,28,4,0,"_dependencyMap"],[22,42,4,0],[23,2,5,0],[23,6,5,0,"_react"],[23,12,5,0],[23,15,5,0,"require"],[23,22,5,0],[23,23,5,0,"_dependencyMap"],[23,37,5,0],[24,2,7,0],[24,6,7,0,"_storeUseUserStore"],[24,24,7,0],[24,27,7,0,"require"],[24,34,7,0],[24,35,7,0,"_dependencyMap"],[24,49,7,0],[25,2,8,0],[25,6,8,0,"_servicesIap"],[25,18,8,0],[25,21,8,0,"require"],[25,28,8,0],[25,29,8,0,"_dependencyMap"],[25,43,8,0],[26,2,8,45],[26,6,8,45,"_reactNativeWebDistExportsUseColorScheme"],[26,46,8,45],[26,49,8,45,"require"],[26,56,8,45],[26,57,8,45,"_dependencyMap"],[26,71,8,45],[27,2,8,45],[27,6,8,45,"useColorScheme"],[27,20,8,45],[27,23,8,45,"_interopDefault"],[27,38,8,45],[27,39,8,45,"_reactNativeWebDistExportsUseColorScheme"],[27,79,8,45],[28,2,8,45],[28,6,8,45,"_reactJsxDevRuntime"],[28,25,8,45],[28,28,8,45,"require"],[28,35,8,45],[28,36,8,45,"_dependencyMap"],[28,50,8,45],[29,2,11,15],[29,11,11,24,"RootLayout"],[29,21,11,34,"RootLayout"],[29,22,11,34],[29,24,11,37],[30,4,12,2],[30,10,12,8,"router"],[30,16,12,14],[30,19,12,17],[30,23,12,17,"useRouter"],[30,34,12,26],[30,35,12,26,"useRouter"],[30,44,12,26],[30,46,12,27],[30,47,12,28],[31,4,13,2],[31,10,13,8,"pathname"],[31,18,13,16],[31,21,13,19],[31,25,13,19,"usePathname"],[31,36,13,30],[31,37,13,30,"usePathname"],[31,48,13,30],[31,50,13,31],[31,51,13,32],[32,4,14,2],[32,10,14,8,"colorScheme"],[32,21,14,19],[32,24,14,22],[32,28,14,22,"useColorScheme"],[32,42,14,36],[32,43,14,36,"default"],[32,50,14,36],[32,52,14,37],[32,53,14,38],[33,4,15,2],[33,10,15,8],[34,6,15,10,"onboardingCompleted"],[34,25,15,29],[35,6,15,31,"getOriginalTransactionId"],[35,30,15,55],[36,6,15,57,"needsServerValidation"],[36,27,15,78],[37,6,15,80,"setSubscription"],[38,4,15,96],[38,5,15,97],[38,8,15,100],[38,12,15,100,"useUserStore"],[38,30,15,112],[38,31,15,112,"useUserStore"],[38,43,15,112],[38,45,15,113],[38,46,15,114],[39,4,16,2],[39,10,16,8,"hasSyncedEntitlement"],[39,30,16,28],[39,33,16,31],[39,37,16,31,"useRef"],[39,43,16,37],[39,44,16,37,"useRef"],[39,50,16,37],[39,52,16,38],[39,57,16,43],[39,58,16,44],[40,4,18,2],[40,8,18,2,"useEffect"],[40,14,18,11],[40,15,18,11,"useEffect"],[40,24,18,11],[40,26,18,12],[40,32,18,18],[41,6,19,4],[42,6,20,4],[42,10,20,8],[42,11,20,9,"onboardingCompleted"],[42,30,20,28],[42,34,20,32,"pathname"],[42,42,20,40],[42,47,20,45],[42,60,20,58],[42,62,20,60],[43,8,21,6,"router"],[43,14,21,12],[43,15,21,13,"replace"],[43,22,21,20],[43,23,21,21],[43,36,21,34],[43,37,21,35],[44,6,22,4],[45,4,23,2],[45,5,23,3],[45,7,23,5],[45,8,23,6,"onboardingCompleted"],[45,27,23,25],[45,29,23,27,"pathname"],[45,37,23,35],[45,38,23,36],[45,39,23,37],[46,4,25,2],[46,8,25,2,"useEffect"],[46,14,25,11],[46,15,25,11,"useEffect"],[46,24,25,11],[46,26,25,12],[46,32,25,18],[47,6,26,4],[48,6,27,4],[48,10,27,8,"hasSyncedEntitlement"],[48,30,27,28],[48,31,27,29,"current"],[48,38,27,36],[48,40,27,38],[49,6,29,4],[49,12,29,10,"syncEntitlement"],[49,27,29,25],[49,30,29,28],[49,36,29,28,"syncEntitlement"],[49,37,29,28],[49,42,29,40],[50,8,30,6],[50,14,30,12,"originalTransactionId"],[50,35,30,33],[50,38,30,36,"getOriginalTransactionId"],[50,62,30,60],[50,63,30,61],[50,64,30,62],[52,8,32,6],[53,8,33,6],[53,12,33,10,"originalTransactionId"],[53,33,33,31],[53,37,33,35,"needsServerValidation"],[53,58,33,56],[53,60,33,58],[54,10,34,8,"hasSyncedEntitlement"],[54,30,34,28],[54,31,34,29,"current"],[54,38,34,36],[54,41,34,39],[54,45,34,43],[55,10,36,8],[55,16,36,14,"state"],[55,21,36,19],[55,24,36,22],[55,30,36,28,"iapService"],[55,42,36,38],[55,43,36,38,"iapService"],[55,53,36,38],[55,54,36,39,"syncEntitlementOnLaunch"],[55,77,36,62],[55,78,37,10,"originalTransactionId"],[55,99,37,31],[55,101,38,10,"needsServerValidation"],[55,122,39,8],[55,123,39,9],[56,10,41,8],[56,14,41,12,"state"],[56,19,41,17],[56,21,41,19],[57,12,42,10,"setSubscription"],[57,27,42,25],[57,28,42,26,"state"],[57,33,42,31],[57,34,42,32],[58,12,43,10,"console"],[58,19,43,17],[58,20,43,18,"log"],[58,23,43,21],[58,24,43,22],[58,63,43,61],[58,65,43,63,"state"],[58,70,43,68],[58,71,43,69,"status"],[58,77,43,75],[58,78,43,76],[59,10,44,8],[60,8,45,6],[61,6,46,4],[61,7,46,5],[62,6,48,4,"syncEntitlement"],[62,21,48,19],[62,22,48,20],[62,23,48,21],[63,4,49,2],[63,5,49,3],[63,7,49,5],[63,9,49,7],[63,10,49,8],[64,4,51,2],[64,24,52,4],[64,28,52,4,"_reactJsxDevRuntime"],[64,47,52,4],[64,48,52,4,"jsxDEV"],[64,54,52,4],[64,56,52,5,"_expoRouter"],[64,67,52,10],[64,68,52,10,"Stack"],[64,73,52,10],[65,6,53,6,"screenOptions"],[65,19,53,19],[65,21,53,21],[66,8,54,8,"headerShown"],[66,19,54,19],[66,21,54,21],[66,26,54,26],[67,8,55,8,"contentStyle"],[67,20,55,20],[67,22,55,22],[68,10,56,10,"backgroundColor"],[68,25,56,25],[68,27,56,27,"colorScheme"],[68,38,56,38],[68,43,56,43],[68,49,56,49],[68,52,56,52],[68,61,56,61],[68,64,56,64],[69,8,57,8],[70,6,58,6],[70,7,58,8],[71,6,58,8,"children"],[71,14,58,8],[71,30,60,6],[71,34,60,6,"_reactJsxDevRuntime"],[71,53,60,6],[71,54,60,6,"jsxDEV"],[71,60,60,6],[71,62,60,7,"_expoRouter"],[71,73,60,12],[71,74,60,12,"Stack"],[71,79,60,12],[71,80,60,13,"Screen"],[71,86,60,19],[72,8,60,20,"name"],[72,12,60,24],[72,14,60,25],[73,6,60,32],[74,8,60,32,"fileName"],[74,16,60,32],[74,18,60,32,"_jsxFileName"],[74,30,60,32],[75,8,60,32,"lineNumber"],[75,18,60,32],[76,8,60,32,"columnNumber"],[76,20,60,32],[77,6,60,32],[77,13,60,34],[77,14,60,35],[77,29,61,6],[77,33,61,6,"_reactJsxDevRuntime"],[77,52,61,6],[77,53,61,6,"jsxDEV"],[77,59,61,6],[77,61,61,7,"_expoRouter"],[77,72,61,12],[77,73,61,12,"Stack"],[77,78,61,12],[77,79,61,13,"Screen"],[77,85,61,19],[78,8,61,20,"name"],[78,12,61,24],[78,14,61,25],[79,6,61,37],[80,8,61,37,"fileName"],[80,16,61,37],[80,18,61,37,"_jsxFileName"],[80,30,61,37],[81,8,61,37,"lineNumber"],[81,18,61,37],[82,8,61,37,"columnNumber"],[82,20,61,37],[83,6,61,37],[83,13,61,39],[83,14,61,40],[83,29,62,6],[83,33,62,6,"_reactJsxDevRuntime"],[83,52,62,6],[83,53,62,6,"jsxDEV"],[83,59,62,6],[83,61,62,7,"_expoRouter"],[83,72,62,12],[83,73,62,12,"Stack"],[83,78,62,12],[83,79,62,13,"Screen"],[83,85,62,19],[84,8,62,20,"name"],[84,12,62,24],[84,14,62,25],[85,6,62,37],[86,8,62,37,"fileName"],[86,16,62,37],[86,18,62,37,"_jsxFileName"],[86,30,62,37],[87,8,62,37,"lineNumber"],[87,18,62,37],[88,8,62,37,"columnNumber"],[88,20,62,37],[89,6,62,37],[89,13,62,39],[89,14,62,40],[89,29,63,6],[89,33,63,6,"_reactJsxDevRuntime"],[89,52,63,6],[89,53,63,6,"jsxDEV"],[89,59,63,6],[89,61,63,7,"_expoRouter"],[89,72,63,12],[89,73,63,12,"Stack"],[89,78,63,12],[89,79,63,13,"Screen"],[89,85,63,19],[90,8,63,20,"name"],[90,12,63,24],[90,14,63,25],[91,6,63,40],[92,8,63,40,"fileName"],[92,16,63,40],[92,18,63,40,"_jsxFileName"],[92,30,63,40],[93,8,63,40,"lineNumber"],[93,18,63,40],[94,8,63,40,"columnNumber"],[94,20,63,40],[95,6,63,40],[95,13,63,42],[95,14,63,43],[95,29,64,6],[95,33,64,6,"_reactJsxDevRuntime"],[95,52,64,6],[95,53,64,6,"jsxDEV"],[95,59,64,6],[95,61,64,7,"_expoRouter"],[95,72,64,12],[95,73,64,12,"Stack"],[95,78,64,12],[95,79,64,13,"Screen"],[95,85,64,19],[96,8,65,8,"name"],[96,12,65,12],[96,14,65,13],[96,28,65,27],[97,8,66,8,"options"],[97,15,66,15],[97,17,66,17],[98,10,67,10,"presentation"],[98,22,67,22],[98,24,67,24],[98,31,67,31],[99,10,68,10,"animation"],[99,19,68,19],[99,21,68,21],[100,8,69,8],[101,6,69,10],[102,8,69,10,"fileName"],[102,16,69,10],[102,18,69,10,"_jsxFileName"],[102,30,69,10],[103,8,69,10,"lineNumber"],[103,18,69,10],[104,8,69,10,"columnNumber"],[104,20,69,10],[105,6,69,10],[105,13,70,7],[105,14,70,8],[106,4,70,8],[107,6,70,8,"fileName"],[107,14,70,8],[107,16,70,8,"_jsxFileName"],[107,28,70,8],[108,6,70,8,"lineNumber"],[108,16,70,8],[109,6,70,8,"columnNumber"],[109,18,70,8],[110,4,70,8],[110,11,71,11],[110,12,71,12],[111,2,73,0],[112,0,73,1],[112,3]],"functionMap":{"names":["<global>","RootLayout","useEffect$argument_0","syncEntitlement"],"mappings":"AAA;eCU;YCO;GDK;YCE;4BCI;KDiB;GDG;CDwB"},"hasCjsExports":false},"type":"js/module"}]}