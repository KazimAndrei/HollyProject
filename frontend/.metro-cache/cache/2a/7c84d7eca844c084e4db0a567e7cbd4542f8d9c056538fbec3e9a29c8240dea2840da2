{"dependencies":[{"name":"expo-router","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":60},"end":{"line":4,"column":36,"index":96}}],"key":"/+ErnBisjrT6aDU+GRp5Qz/lYoY=","exportNames":["*"],"imports":1}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":97},"end":{"line":5,"column":42,"index":139}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"../store/useUserStore","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":194},"end":{"line":7,"column":53,"index":247}}],"key":"5ijXyHjMlsfMZei+m4htNVv9OS4=","exportNames":["*"],"imports":1}},{"name":"../services/iap","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":8,"column":0,"index":248},"end":{"line":8,"column":45,"index":293}}],"key":"zOAPumWACsQPB7n8LLRKc7XVPSY=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/useColorScheme","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"gdN+P7eDH4evn7jZBGQVY+YTEvw=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/app/_layout.tsx\",\n    _s = $RefreshSig$();\n  /**\n   * Root layout with navigation and onboarding check\n   */\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return RootLayout;\n    }\n  });\n  var _expoRouter = require(_dependencyMap[0], \"expo-router\");\n  var _react = require(_dependencyMap[1], \"react\");\n  var _storeUseUserStore = require(_dependencyMap[2], \"../store/useUserStore\");\n  var _servicesIap = require(_dependencyMap[3], \"../services/iap\");\n  var _reactNativeWebDistExportsUseColorScheme = require(_dependencyMap[4], \"react-native-web/dist/exports/useColorScheme\");\n  var useColorScheme = _interopDefault(_reactNativeWebDistExportsUseColorScheme);\n  var _reactJsxDevRuntime = require(_dependencyMap[5], \"react/jsx-dev-runtime\");\n  function RootLayout() {\n    _s();\n    const router = (0, _expoRouter.useRouter)();\n    const pathname = (0, _expoRouter.usePathname)();\n    const colorScheme = (0, useColorScheme.default)();\n    const {\n      onboardingCompleted,\n      getOriginalTransactionId,\n      needsServerValidation,\n      setSubscription\n    } = (0, _storeUseUserStore.useUserStore)();\n    const hasSyncedEntitlement = (0, _react.useRef)(false);\n    (0, _react.useEffect)(() => {\n      // Check onboarding status and redirect (but not if already on onboarding)\n      if (!onboardingCompleted && pathname !== '/onboarding') {\n        router.replace('/onboarding');\n      }\n    }, [onboardingCompleted, pathname]);\n    (0, _react.useEffect)(() => {\n      // Sync entitlement on launch (once per session)\n      if (hasSyncedEntitlement.current) return;\n      const syncEntitlement = async () => {\n        const originalTransactionId = getOriginalTransactionId();\n\n        // Sync if we have a transaction ID or need validation\n        if (originalTransactionId || needsServerValidation) {\n          hasSyncedEntitlement.current = true;\n          const state = await _servicesIap.iapService.syncEntitlementOnLaunch(originalTransactionId, needsServerValidation);\n          if (state) {\n            setSubscription(state);\n            console.log('âœ… [App] Entitlement synced on launch:', state.status);\n          }\n        }\n      };\n      syncEntitlement();\n    }, []);\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_expoRouter.Stack, {\n      screenOptions: {\n        headerShown: false,\n        contentStyle: {\n          backgroundColor: colorScheme === 'dark' ? '#0E1115' : '#F7F8FA'\n        }\n      },\n      children: [/*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_expoRouter.Stack.Screen, {\n        name: \"index\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 7\n      }, this), /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_expoRouter.Stack.Screen, {\n        name: \"onboarding\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 7\n      }, this), /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_expoRouter.Stack.Screen, {\n        name: \"chat/index\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 7\n      }, this), /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_expoRouter.Stack.Screen, {\n        name: \"passage/[ref]\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 7\n      }, this), /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_expoRouter.Stack.Screen, {\n        name: \"subscription\",\n        options: {\n          presentation: 'modal',\n          animation: 'slide_from_bottom'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 5\n    }, this);\n  }\n  _s(RootLayout, \"ujC3SY5wKgmuFe7Lct1rFbOBNe4=\", false, function () {\n    return [_expoRouter.useRouter, _expoRouter.usePathname, useColorScheme.default, _storeUseUserStore.useUserStore];\n  });\n  _c = RootLayout;\n  var _c;\n  $RefreshReg$(_c, \"RootLayout\");\n});","lineCount":120,"map":[[6,2,1,0],[7,0,2,0],[8,0,3,0],[9,2,1,0,"Object"],[9,8,1,0],[9,9,1,0,"defineProperty"],[9,23,1,0],[9,24,1,0,"exports"],[9,31,1,0],[10,4,1,0,"value"],[10,9,1,0],[11,2,1,0],[12,2,1,0],[12,11,1,0,"_interopDefault"],[12,27,1,0,"e"],[12,28,1,0],[13,4,1,0],[13,11,1,0,"e"],[13,12,1,0],[13,16,1,0,"e"],[13,17,1,0],[13,18,1,0,"__esModule"],[13,28,1,0],[13,31,1,0,"e"],[13,32,1,0],[14,6,1,0,"default"],[14,13,1,0],[14,15,1,0,"e"],[15,4,1,0],[16,2,1,0],[17,2,11,15,"Object"],[17,8,11,15],[17,9,11,15,"defineProperty"],[17,23,11,15],[17,24,11,15,"exports"],[17,31,11,15],[18,4,11,15,"enumerable"],[18,14,11,15],[19,4,11,15,"get"],[19,7,11,15],[19,18,11,15,"get"],[19,19,11,15],[20,6,11,15],[20,13,11,15,"RootLayout"],[20,23,11,15],[21,4,11,15],[22,2,11,15],[23,2,4,0],[23,6,4,0,"_expoRouter"],[23,17,4,0],[23,20,4,0,"require"],[23,27,4,0],[23,28,4,0,"_dependencyMap"],[23,42,4,0],[24,2,5,0],[24,6,5,0,"_react"],[24,12,5,0],[24,15,5,0,"require"],[24,22,5,0],[24,23,5,0,"_dependencyMap"],[24,37,5,0],[25,2,7,0],[25,6,7,0,"_storeUseUserStore"],[25,24,7,0],[25,27,7,0,"require"],[25,34,7,0],[25,35,7,0,"_dependencyMap"],[25,49,7,0],[26,2,8,0],[26,6,8,0,"_servicesIap"],[26,18,8,0],[26,21,8,0,"require"],[26,28,8,0],[26,29,8,0,"_dependencyMap"],[26,43,8,0],[27,2,8,45],[27,6,8,45,"_reactNativeWebDistExportsUseColorScheme"],[27,46,8,45],[27,49,8,45,"require"],[27,56,8,45],[27,57,8,45,"_dependencyMap"],[27,71,8,45],[28,2,8,45],[28,6,8,45,"useColorScheme"],[28,20,8,45],[28,23,8,45,"_interopDefault"],[28,38,8,45],[28,39,8,45,"_reactNativeWebDistExportsUseColorScheme"],[28,79,8,45],[29,2,8,45],[29,6,8,45,"_reactJsxDevRuntime"],[29,25,8,45],[29,28,8,45,"require"],[29,35,8,45],[29,36,8,45,"_dependencyMap"],[29,50,8,45],[30,2,11,15],[30,11,11,24,"RootLayout"],[30,21,11,34,"RootLayout"],[30,22,11,34],[30,24,11,37],[31,4,11,37,"_s"],[31,6,11,37],[32,4,12,2],[32,10,12,8,"router"],[32,16,12,14],[32,19,12,17],[32,23,12,17,"useRouter"],[32,34,12,26],[32,35,12,26,"useRouter"],[32,44,12,26],[32,46,12,27],[32,47,12,28],[33,4,13,2],[33,10,13,8,"pathname"],[33,18,13,16],[33,21,13,19],[33,25,13,19,"usePathname"],[33,36,13,30],[33,37,13,30,"usePathname"],[33,48,13,30],[33,50,13,31],[33,51,13,32],[34,4,14,2],[34,10,14,8,"colorScheme"],[34,21,14,19],[34,24,14,22],[34,28,14,22,"useColorScheme"],[34,42,14,36],[34,43,14,36,"default"],[34,50,14,36],[34,52,14,37],[34,53,14,38],[35,4,15,2],[35,10,15,8],[36,6,15,10,"onboardingCompleted"],[36,25,15,29],[37,6,15,31,"getOriginalTransactionId"],[37,30,15,55],[38,6,15,57,"needsServerValidation"],[38,27,15,78],[39,6,15,80,"setSubscription"],[40,4,15,96],[40,5,15,97],[40,8,15,100],[40,12,15,100,"useUserStore"],[40,30,15,112],[40,31,15,112,"useUserStore"],[40,43,15,112],[40,45,15,113],[40,46,15,114],[41,4,16,2],[41,10,16,8,"hasSyncedEntitlement"],[41,30,16,28],[41,33,16,31],[41,37,16,31,"useRef"],[41,43,16,37],[41,44,16,37,"useRef"],[41,50,16,37],[41,52,16,38],[41,57,16,43],[41,58,16,44],[42,4,18,2],[42,8,18,2,"useEffect"],[42,14,18,11],[42,15,18,11,"useEffect"],[42,24,18,11],[42,26,18,12],[42,32,18,18],[43,6,19,4],[44,6,20,4],[44,10,20,8],[44,11,20,9,"onboardingCompleted"],[44,30,20,28],[44,34,20,32,"pathname"],[44,42,20,40],[44,47,20,45],[44,60,20,58],[44,62,20,60],[45,8,21,6,"router"],[45,14,21,12],[45,15,21,13,"replace"],[45,22,21,20],[45,23,21,21],[45,36,21,34],[45,37,21,35],[46,6,22,4],[47,4,23,2],[47,5,23,3],[47,7,23,5],[47,8,23,6,"onboardingCompleted"],[47,27,23,25],[47,29,23,27,"pathname"],[47,37,23,35],[47,38,23,36],[47,39,23,37],[48,4,25,2],[48,8,25,2,"useEffect"],[48,14,25,11],[48,15,25,11,"useEffect"],[48,24,25,11],[48,26,25,12],[48,32,25,18],[49,6,26,4],[50,6,27,4],[50,10,27,8,"hasSyncedEntitlement"],[50,30,27,28],[50,31,27,29,"current"],[50,38,27,36],[50,40,27,38],[51,6,29,4],[51,12,29,10,"syncEntitlement"],[51,27,29,25],[51,30,29,28],[51,36,29,28,"syncEntitlement"],[51,37,29,28],[51,42,29,40],[52,8,30,6],[52,14,30,12,"originalTransactionId"],[52,35,30,33],[52,38,30,36,"getOriginalTransactionId"],[52,62,30,60],[52,63,30,61],[52,64,30,62],[54,8,32,6],[55,8,33,6],[55,12,33,10,"originalTransactionId"],[55,33,33,31],[55,37,33,35,"needsServerValidation"],[55,58,33,56],[55,60,33,58],[56,10,34,8,"hasSyncedEntitlement"],[56,30,34,28],[56,31,34,29,"current"],[56,38,34,36],[56,41,34,39],[56,45,34,43],[57,10,36,8],[57,16,36,14,"state"],[57,21,36,19],[57,24,36,22],[57,30,36,28,"iapService"],[57,42,36,38],[57,43,36,38,"iapService"],[57,53,36,38],[57,54,36,39,"syncEntitlementOnLaunch"],[57,77,36,62],[57,78,37,10,"originalTransactionId"],[57,99,37,31],[57,101,38,10,"needsServerValidation"],[57,122,39,8],[57,123,39,9],[58,10,41,8],[58,14,41,12,"state"],[58,19,41,17],[58,21,41,19],[59,12,42,10,"setSubscription"],[59,27,42,25],[59,28,42,26,"state"],[59,33,42,31],[59,34,42,32],[60,12,43,10,"console"],[60,19,43,17],[60,20,43,18,"log"],[60,23,43,21],[60,24,43,22],[60,63,43,61],[60,65,43,63,"state"],[60,70,43,68],[60,71,43,69,"status"],[60,77,43,75],[60,78,43,76],[61,10,44,8],[62,8,45,6],[63,6,46,4],[63,7,46,5],[64,6,48,4,"syncEntitlement"],[64,21,48,19],[64,22,48,20],[64,23,48,21],[65,4,49,2],[65,5,49,3],[65,7,49,5],[65,9,49,7],[65,10,49,8],[66,4,51,2],[66,24,52,4],[66,28,52,4,"_reactJsxDevRuntime"],[66,47,52,4],[66,48,52,4,"jsxDEV"],[66,54,52,4],[66,56,52,5,"_expoRouter"],[66,67,52,10],[66,68,52,10,"Stack"],[66,73,52,10],[67,6,53,6,"screenOptions"],[67,19,53,19],[67,21,53,21],[68,8,54,8,"headerShown"],[68,19,54,19],[68,21,54,21],[68,26,54,26],[69,8,55,8,"contentStyle"],[69,20,55,20],[69,22,55,22],[70,10,56,10,"backgroundColor"],[70,25,56,25],[70,27,56,27,"colorScheme"],[70,38,56,38],[70,43,56,43],[70,49,56,49],[70,52,56,52],[70,61,56,61],[70,64,56,64],[71,8,57,8],[72,6,58,6],[72,7,58,8],[73,6,58,8,"children"],[73,14,58,8],[73,30,60,6],[73,34,60,6,"_reactJsxDevRuntime"],[73,53,60,6],[73,54,60,6,"jsxDEV"],[73,60,60,6],[73,62,60,7,"_expoRouter"],[73,73,60,12],[73,74,60,12,"Stack"],[73,79,60,12],[73,80,60,13,"Screen"],[73,86,60,19],[74,8,60,20,"name"],[74,12,60,24],[74,14,60,25],[75,6,60,32],[76,8,60,32,"fileName"],[76,16,60,32],[76,18,60,32,"_jsxFileName"],[76,30,60,32],[77,8,60,32,"lineNumber"],[77,18,60,32],[78,8,60,32,"columnNumber"],[78,20,60,32],[79,6,60,32],[79,13,60,34],[79,14,60,35],[79,29,61,6],[79,33,61,6,"_reactJsxDevRuntime"],[79,52,61,6],[79,53,61,6,"jsxDEV"],[79,59,61,6],[79,61,61,7,"_expoRouter"],[79,72,61,12],[79,73,61,12,"Stack"],[79,78,61,12],[79,79,61,13,"Screen"],[79,85,61,19],[80,8,61,20,"name"],[80,12,61,24],[80,14,61,25],[81,6,61,37],[82,8,61,37,"fileName"],[82,16,61,37],[82,18,61,37,"_jsxFileName"],[82,30,61,37],[83,8,61,37,"lineNumber"],[83,18,61,37],[84,8,61,37,"columnNumber"],[84,20,61,37],[85,6,61,37],[85,13,61,39],[85,14,61,40],[85,29,62,6],[85,33,62,6,"_reactJsxDevRuntime"],[85,52,62,6],[85,53,62,6,"jsxDEV"],[85,59,62,6],[85,61,62,7,"_expoRouter"],[85,72,62,12],[85,73,62,12,"Stack"],[85,78,62,12],[85,79,62,13,"Screen"],[85,85,62,19],[86,8,62,20,"name"],[86,12,62,24],[86,14,62,25],[87,6,62,37],[88,8,62,37,"fileName"],[88,16,62,37],[88,18,62,37,"_jsxFileName"],[88,30,62,37],[89,8,62,37,"lineNumber"],[89,18,62,37],[90,8,62,37,"columnNumber"],[90,20,62,37],[91,6,62,37],[91,13,62,39],[91,14,62,40],[91,29,63,6],[91,33,63,6,"_reactJsxDevRuntime"],[91,52,63,6],[91,53,63,6,"jsxDEV"],[91,59,63,6],[91,61,63,7,"_expoRouter"],[91,72,63,12],[91,73,63,12,"Stack"],[91,78,63,12],[91,79,63,13,"Screen"],[91,85,63,19],[92,8,63,20,"name"],[92,12,63,24],[92,14,63,25],[93,6,63,40],[94,8,63,40,"fileName"],[94,16,63,40],[94,18,63,40,"_jsxFileName"],[94,30,63,40],[95,8,63,40,"lineNumber"],[95,18,63,40],[96,8,63,40,"columnNumber"],[96,20,63,40],[97,6,63,40],[97,13,63,42],[97,14,63,43],[97,29,64,6],[97,33,64,6,"_reactJsxDevRuntime"],[97,52,64,6],[97,53,64,6,"jsxDEV"],[97,59,64,6],[97,61,64,7,"_expoRouter"],[97,72,64,12],[97,73,64,12,"Stack"],[97,78,64,12],[97,79,64,13,"Screen"],[97,85,64,19],[98,8,65,8,"name"],[98,12,65,12],[98,14,65,13],[98,28,65,27],[99,8,66,8,"options"],[99,15,66,15],[99,17,66,17],[100,10,67,10,"presentation"],[100,22,67,22],[100,24,67,24],[100,31,67,31],[101,10,68,10,"animation"],[101,19,68,19],[101,21,68,21],[102,8,69,8],[103,6,69,10],[104,8,69,10,"fileName"],[104,16,69,10],[104,18,69,10,"_jsxFileName"],[104,30,69,10],[105,8,69,10,"lineNumber"],[105,18,69,10],[106,8,69,10,"columnNumber"],[106,20,69,10],[107,6,69,10],[107,13,70,7],[107,14,70,8],[108,4,70,8],[109,6,70,8,"fileName"],[109,14,70,8],[109,16,70,8,"_jsxFileName"],[109,28,70,8],[110,6,70,8,"lineNumber"],[110,16,70,8],[111,6,70,8,"columnNumber"],[111,18,70,8],[112,4,70,8],[112,11,71,11],[112,12,71,12],[113,2,73,0],[114,2,73,1,"_s"],[114,4,73,1],[114,5,11,24,"RootLayout"],[114,15,11,34],[115,4,11,34],[115,12,12,17,"useRouter"],[115,23,12,26],[115,24,12,26,"useRouter"],[115,33,12,26],[115,35,13,19,"usePathname"],[115,46,13,30],[115,47,13,30,"usePathname"],[115,58,13,30],[115,60,14,22,"useColorScheme"],[115,74,14,36],[115,75,14,36,"default"],[115,82,14,36],[115,84,15,100,"useUserStore"],[115,102,15,112],[115,103,15,112,"useUserStore"],[115,115,15,112],[116,2,15,112],[117,2,15,112,"_c"],[117,4,15,112],[117,7,11,24,"RootLayout"],[117,17,11,34],[118,2,11,34],[118,6,11,34,"_c"],[118,8,11,34],[119,2,11,34,"$RefreshReg$"],[119,14,11,34],[119,15,11,34,"_c"],[119,17,11,34],[120,0,11,34],[120,3]],"functionMap":{"names":["<global>","RootLayout","useEffect$argument_0","syncEntitlement"],"mappings":"AAA;eCU;YCO;GDK;YCE;4BCI;KDiB;GDG;CDwB"},"hasCjsExports":false},"type":"js/module"}]}