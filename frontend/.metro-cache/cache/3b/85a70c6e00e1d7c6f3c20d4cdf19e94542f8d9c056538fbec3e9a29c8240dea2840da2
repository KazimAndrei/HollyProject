{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"expo-router","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":60},"end":{"line":4,"column":36,"index":96}}],"key":"/+ErnBisjrT6aDU+GRp5Qz/lYoY=","exportNames":["*"],"imports":1}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":97},"end":{"line":5,"column":42,"index":139}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"../store/useUserStore","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":194},"end":{"line":7,"column":53,"index":247}}],"key":"5ijXyHjMlsfMZei+m4htNVv9OS4=","exportNames":["*"],"imports":1}},{"name":"../services/iap","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":8,"column":0,"index":248},"end":{"line":8,"column":45,"index":293}}],"key":"zOAPumWACsQPB7n8LLRKc7XVPSY=","exportNames":["*"],"imports":1}},{"name":"react-native","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":9,"column":0,"index":294},"end":{"line":9,"column":46,"index":340}}],"key":"KyzuX10g6ixS9UfynhmjlvCIG3g=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/app/_layout.tsx\",\n    _s = $RefreshSig$();\n  /**\n   * Root layout with navigation and onboarding check\n   */\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return RootLayout;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _expoRouter = require(_dependencyMap[1], \"expo-router\");\n  var _react = require(_dependencyMap[2], \"react\");\n  var _storeUseUserStore = require(_dependencyMap[3], \"../store/useUserStore\");\n  var _servicesIap = require(_dependencyMap[4], \"../services/iap\");\n  var _reactNative = require(_dependencyMap[5], \"react-native\");\n  var _reactJsxDevRuntime = require(_dependencyMap[6], \"react/jsx-dev-runtime\");\n  function RootLayout() {\n    _s();\n    var router = (0, _expoRouter.useRouter)();\n    var pathname = (0, _expoRouter.usePathname)();\n    var colorScheme = (0, _reactNative.useColorScheme)();\n    var _useUserStore = (0, _storeUseUserStore.useUserStore)(),\n      onboardingCompleted = _useUserStore.onboardingCompleted,\n      getOriginalTransactionId = _useUserStore.getOriginalTransactionId,\n      needsServerValidation = _useUserStore.needsServerValidation,\n      setSubscription = _useUserStore.setSubscription;\n    var hasSyncedEntitlement = (0, _react.useRef)(false);\n    (0, _react.useEffect)(() => {\n      // Check onboarding status and redirect (but not if already on onboarding)\n      if (!onboardingCompleted && pathname !== '/onboarding') {\n        router.replace('/onboarding');\n      }\n    }, [onboardingCompleted, pathname]);\n    (0, _react.useEffect)(() => {\n      // Sync entitlement on launch (once per session)\n      if (hasSyncedEntitlement.current) return;\n      var syncEntitlement = /*#__PURE__*/function () {\n        var _ref = (0, _asyncToGenerator.default)(function* () {\n          var originalTransactionId = getOriginalTransactionId();\n\n          // Sync if we have a transaction ID or need validation\n          if (originalTransactionId || needsServerValidation) {\n            hasSyncedEntitlement.current = true;\n            var state = yield _servicesIap.iapService.syncEntitlementOnLaunch(originalTransactionId, needsServerValidation);\n            if (state) {\n              setSubscription(state);\n              console.log('âœ… [App] Entitlement synced on launch:', state.status);\n            }\n          }\n        });\n        return function syncEntitlement() {\n          return _ref.apply(this, arguments);\n        };\n      }();\n      syncEntitlement();\n    }, []);\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_expoRouter.Stack, {\n      screenOptions: {\n        headerShown: false,\n        contentStyle: {\n          backgroundColor: colorScheme === 'dark' ? '#0E1115' : '#F7F8FA'\n        }\n      },\n      children: [/*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_expoRouter.Stack.Screen, {\n        name: \"index\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 7\n      }, this), /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_expoRouter.Stack.Screen, {\n        name: \"onboarding\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 7\n      }, this), /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_expoRouter.Stack.Screen, {\n        name: \"chat/index\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 7\n      }, this), /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_expoRouter.Stack.Screen, {\n        name: \"passage/[ref]\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 7\n      }, this), /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_expoRouter.Stack.Screen, {\n        name: \"subscription\",\n        options: {\n          presentation: 'modal',\n          animation: 'slide_from_bottom'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 5\n    }, this);\n  }\n  _s(RootLayout, \"ujC3SY5wKgmuFe7Lct1rFbOBNe4=\", false, function () {\n    return [_expoRouter.useRouter, _expoRouter.usePathname, _reactNative.useColorScheme, _storeUseUserStore.useUserStore];\n  });\n  _c = RootLayout;\n  var _c;\n  $RefreshReg$(_c, \"RootLayout\");\n});","lineCount":125,"map":[[6,2,1,0],[7,0,2,0],[8,0,3,0],[9,2,1,0,"Object"],[9,8,1,0],[9,9,1,0,"defineProperty"],[9,23,1,0],[9,24,1,0,"exports"],[9,31,1,0],[10,4,1,0,"value"],[10,9,1,0],[11,2,1,0],[12,2,1,0],[12,11,1,0,"_interopDefault"],[12,27,1,0,"e"],[12,28,1,0],[13,4,1,0],[13,11,1,0,"e"],[13,12,1,0],[13,16,1,0,"e"],[13,17,1,0],[13,18,1,0,"__esModule"],[13,28,1,0],[13,31,1,0,"e"],[13,32,1,0],[14,6,1,0,"default"],[14,13,1,0],[14,15,1,0,"e"],[15,4,1,0],[16,2,1,0],[17,2,11,15,"Object"],[17,8,11,15],[17,9,11,15,"defineProperty"],[17,23,11,15],[17,24,11,15,"exports"],[17,31,11,15],[18,4,11,15,"enumerable"],[18,14,11,15],[19,4,11,15,"get"],[19,7,11,15],[19,18,11,15,"get"],[19,19,11,15],[20,6,11,15],[20,13,11,15,"RootLayout"],[20,23,11,15],[21,4,11,15],[22,2,11,15],[23,2,73,1],[23,6,73,1,"_babelRuntimeHelpersAsyncToGenerator"],[23,42,73,1],[23,45,73,1,"require"],[23,52,73,1],[23,53,73,1,"_dependencyMap"],[23,67,73,1],[24,2,73,1],[24,6,73,1,"_asyncToGenerator"],[24,23,73,1],[24,26,73,1,"_interopDefault"],[24,41,73,1],[24,42,73,1,"_babelRuntimeHelpersAsyncToGenerator"],[24,78,73,1],[25,2,4,0],[25,6,4,0,"_expoRouter"],[25,17,4,0],[25,20,4,0,"require"],[25,27,4,0],[25,28,4,0,"_dependencyMap"],[25,42,4,0],[26,2,5,0],[26,6,5,0,"_react"],[26,12,5,0],[26,15,5,0,"require"],[26,22,5,0],[26,23,5,0,"_dependencyMap"],[26,37,5,0],[27,2,7,0],[27,6,7,0,"_storeUseUserStore"],[27,24,7,0],[27,27,7,0,"require"],[27,34,7,0],[27,35,7,0,"_dependencyMap"],[27,49,7,0],[28,2,8,0],[28,6,8,0,"_servicesIap"],[28,18,8,0],[28,21,8,0,"require"],[28,28,8,0],[28,29,8,0,"_dependencyMap"],[28,43,8,0],[29,2,9,0],[29,6,9,0,"_reactNative"],[29,18,9,0],[29,21,9,0,"require"],[29,28,9,0],[29,29,9,0,"_dependencyMap"],[29,43,9,0],[30,2,9,46],[30,6,9,46,"_reactJsxDevRuntime"],[30,25,9,46],[30,28,9,46,"require"],[30,35,9,46],[30,36,9,46,"_dependencyMap"],[30,50,9,46],[31,2,11,15],[31,11,11,24,"RootLayout"],[31,21,11,34,"RootLayout"],[31,22,11,34],[31,24,11,37],[32,4,11,37,"_s"],[32,6,11,37],[33,4,12,2],[33,8,12,8,"router"],[33,14,12,14],[33,17,12,17],[33,21,12,17,"useRouter"],[33,32,12,26],[33,33,12,26,"useRouter"],[33,42,12,26],[33,44,12,27],[33,45,12,28],[34,4,13,2],[34,8,13,8,"pathname"],[34,16,13,16],[34,19,13,19],[34,23,13,19,"usePathname"],[34,34,13,30],[34,35,13,30,"usePathname"],[34,46,13,30],[34,48,13,31],[34,49,13,32],[35,4,14,2],[35,8,14,8,"colorScheme"],[35,19,14,19],[35,22,14,22],[35,26,14,22,"useColorScheme"],[35,38,14,36],[35,39,14,36,"useColorScheme"],[35,53,14,36],[35,55,14,37],[35,56,14,38],[36,4,15,2],[36,8,15,2,"_useUserStore"],[36,21,15,2],[36,24,15,100],[36,28,15,100,"useUserStore"],[36,46,15,112],[36,47,15,112,"useUserStore"],[36,59,15,112],[36,61,15,113],[36,62,15,114],[37,6,15,10,"onboardingCompleted"],[37,25,15,29],[37,28,15,29,"_useUserStore"],[37,41,15,29],[37,42,15,10,"onboardingCompleted"],[37,61,15,29],[38,6,15,31,"getOriginalTransactionId"],[38,30,15,55],[38,33,15,55,"_useUserStore"],[38,46,15,55],[38,47,15,31,"getOriginalTransactionId"],[38,71,15,55],[39,6,15,57,"needsServerValidation"],[39,27,15,78],[39,30,15,78,"_useUserStore"],[39,43,15,78],[39,44,15,57,"needsServerValidation"],[39,65,15,78],[40,6,15,80,"setSubscription"],[40,21,15,95],[40,24,15,95,"_useUserStore"],[40,37,15,95],[40,38,15,80,"setSubscription"],[40,53,15,95],[41,4,16,2],[41,8,16,8,"hasSyncedEntitlement"],[41,28,16,28],[41,31,16,31],[41,35,16,31,"useRef"],[41,41,16,37],[41,42,16,37,"useRef"],[41,48,16,37],[41,50,16,38],[41,55,16,43],[41,56,16,44],[42,4,18,2],[42,8,18,2,"useEffect"],[42,14,18,11],[42,15,18,11,"useEffect"],[42,24,18,11],[42,26,18,12],[42,32,18,18],[43,6,19,4],[44,6,20,4],[44,10,20,8],[44,11,20,9,"onboardingCompleted"],[44,30,20,28],[44,34,20,32,"pathname"],[44,42,20,40],[44,47,20,45],[44,60,20,58],[44,62,20,60],[45,8,21,6,"router"],[45,14,21,12],[45,15,21,13,"replace"],[45,22,21,20],[45,23,21,21],[45,36,21,34],[45,37,21,35],[46,6,22,4],[47,4,23,2],[47,5,23,3],[47,7,23,5],[47,8,23,6,"onboardingCompleted"],[47,27,23,25],[47,29,23,27,"pathname"],[47,37,23,35],[47,38,23,36],[47,39,23,37],[48,4,25,2],[48,8,25,2,"useEffect"],[48,14,25,11],[48,15,25,11,"useEffect"],[48,24,25,11],[48,26,25,12],[48,32,25,18],[49,6,26,4],[50,6,27,4],[50,10,27,8,"hasSyncedEntitlement"],[50,30,27,28],[50,31,27,29,"current"],[50,38,27,36],[50,40,27,38],[51,6,29,4],[51,10,29,10,"syncEntitlement"],[51,25,29,25],[52,8,29,25],[52,12,29,25,"_ref"],[52,16,29,25],[52,23,29,25,"_asyncToGenerator"],[52,40,29,25],[52,41,29,25,"default"],[52,48,29,25],[52,50,29,28],[52,63,29,40],[53,10,30,6],[53,14,30,12,"originalTransactionId"],[53,35,30,33],[53,38,30,36,"getOriginalTransactionId"],[53,62,30,60],[53,63,30,61],[53,64,30,62],[55,10,32,6],[56,10,33,6],[56,14,33,10,"originalTransactionId"],[56,35,33,31],[56,39,33,35,"needsServerValidation"],[56,60,33,56],[56,62,33,58],[57,12,34,8,"hasSyncedEntitlement"],[57,32,34,28],[57,33,34,29,"current"],[57,40,34,36],[57,43,34,39],[57,47,34,43],[58,12,36,8],[58,16,36,14,"state"],[58,21,36,19],[58,30,36,28,"iapService"],[58,42,36,38],[58,43,36,38,"iapService"],[58,53,36,38],[58,54,36,39,"syncEntitlementOnLaunch"],[58,77,36,62],[58,78,37,10,"originalTransactionId"],[58,99,37,31],[58,101,38,10,"needsServerValidation"],[58,122,39,8],[58,123,39,9],[59,12,41,8],[59,16,41,12,"state"],[59,21,41,17],[59,23,41,19],[60,14,42,10,"setSubscription"],[60,29,42,25],[60,30,42,26,"state"],[60,35,42,31],[60,36,42,32],[61,14,43,10,"console"],[61,21,43,17],[61,22,43,18,"log"],[61,25,43,21],[61,26,43,22],[61,65,43,61],[61,67,43,63,"state"],[61,72,43,68],[61,73,43,69,"status"],[61,79,43,75],[61,80,43,76],[62,12,44,8],[63,10,45,6],[64,8,46,4],[64,9,46,5],[65,8,46,5],[65,24,29,10,"syncEntitlement"],[65,39,29,25,"syncEntitlement"],[65,40,29,25],[66,10,29,25],[66,17,29,25,"_ref"],[66,21,29,25],[66,22,29,25,"apply"],[66,27,29,25],[66,34,29,25,"arguments"],[66,43,29,25],[67,8,29,25],[68,6,29,25],[68,9,46,5],[69,6,48,4,"syncEntitlement"],[69,21,48,19],[69,22,48,20],[69,23,48,21],[70,4,49,2],[70,5,49,3],[70,7,49,5],[70,9,49,7],[70,10,49,8],[71,4,51,2],[71,24,52,4],[71,28,52,4,"_reactJsxDevRuntime"],[71,47,52,4],[71,48,52,4,"jsxDEV"],[71,54,52,4],[71,56,52,5,"_expoRouter"],[71,67,52,10],[71,68,52,10,"Stack"],[71,73,52,10],[72,6,53,6,"screenOptions"],[72,19,53,19],[72,21,53,21],[73,8,54,8,"headerShown"],[73,19,54,19],[73,21,54,21],[73,26,54,26],[74,8,55,8,"contentStyle"],[74,20,55,20],[74,22,55,22],[75,10,56,10,"backgroundColor"],[75,25,56,25],[75,27,56,27,"colorScheme"],[75,38,56,38],[75,43,56,43],[75,49,56,49],[75,52,56,52],[75,61,56,61],[75,64,56,64],[76,8,57,8],[77,6,58,6],[77,7,58,8],[78,6,58,8,"children"],[78,14,58,8],[78,30,60,6],[78,34,60,6,"_reactJsxDevRuntime"],[78,53,60,6],[78,54,60,6,"jsxDEV"],[78,60,60,6],[78,62,60,7,"_expoRouter"],[78,73,60,12],[78,74,60,12,"Stack"],[78,79,60,12],[78,80,60,13,"Screen"],[78,86,60,19],[79,8,60,20,"name"],[79,12,60,24],[79,14,60,25],[80,6,60,32],[81,8,60,32,"fileName"],[81,16,60,32],[81,18,60,32,"_jsxFileName"],[81,30,60,32],[82,8,60,32,"lineNumber"],[82,18,60,32],[83,8,60,32,"columnNumber"],[83,20,60,32],[84,6,60,32],[84,13,60,34],[84,14,60,35],[84,29,61,6],[84,33,61,6,"_reactJsxDevRuntime"],[84,52,61,6],[84,53,61,6,"jsxDEV"],[84,59,61,6],[84,61,61,7,"_expoRouter"],[84,72,61,12],[84,73,61,12,"Stack"],[84,78,61,12],[84,79,61,13,"Screen"],[84,85,61,19],[85,8,61,20,"name"],[85,12,61,24],[85,14,61,25],[86,6,61,37],[87,8,61,37,"fileName"],[87,16,61,37],[87,18,61,37,"_jsxFileName"],[87,30,61,37],[88,8,61,37,"lineNumber"],[88,18,61,37],[89,8,61,37,"columnNumber"],[89,20,61,37],[90,6,61,37],[90,13,61,39],[90,14,61,40],[90,29,62,6],[90,33,62,6,"_reactJsxDevRuntime"],[90,52,62,6],[90,53,62,6,"jsxDEV"],[90,59,62,6],[90,61,62,7,"_expoRouter"],[90,72,62,12],[90,73,62,12,"Stack"],[90,78,62,12],[90,79,62,13,"Screen"],[90,85,62,19],[91,8,62,20,"name"],[91,12,62,24],[91,14,62,25],[92,6,62,37],[93,8,62,37,"fileName"],[93,16,62,37],[93,18,62,37,"_jsxFileName"],[93,30,62,37],[94,8,62,37,"lineNumber"],[94,18,62,37],[95,8,62,37,"columnNumber"],[95,20,62,37],[96,6,62,37],[96,13,62,39],[96,14,62,40],[96,29,63,6],[96,33,63,6,"_reactJsxDevRuntime"],[96,52,63,6],[96,53,63,6,"jsxDEV"],[96,59,63,6],[96,61,63,7,"_expoRouter"],[96,72,63,12],[96,73,63,12,"Stack"],[96,78,63,12],[96,79,63,13,"Screen"],[96,85,63,19],[97,8,63,20,"name"],[97,12,63,24],[97,14,63,25],[98,6,63,40],[99,8,63,40,"fileName"],[99,16,63,40],[99,18,63,40,"_jsxFileName"],[99,30,63,40],[100,8,63,40,"lineNumber"],[100,18,63,40],[101,8,63,40,"columnNumber"],[101,20,63,40],[102,6,63,40],[102,13,63,42],[102,14,63,43],[102,29,64,6],[102,33,64,6,"_reactJsxDevRuntime"],[102,52,64,6],[102,53,64,6,"jsxDEV"],[102,59,64,6],[102,61,64,7,"_expoRouter"],[102,72,64,12],[102,73,64,12,"Stack"],[102,78,64,12],[102,79,64,13,"Screen"],[102,85,64,19],[103,8,65,8,"name"],[103,12,65,12],[103,14,65,13],[103,28,65,27],[104,8,66,8,"options"],[104,15,66,15],[104,17,66,17],[105,10,67,10,"presentation"],[105,22,67,22],[105,24,67,24],[105,31,67,31],[106,10,68,10,"animation"],[106,19,68,19],[106,21,68,21],[107,8,69,8],[108,6,69,10],[109,8,69,10,"fileName"],[109,16,69,10],[109,18,69,10,"_jsxFileName"],[109,30,69,10],[110,8,69,10,"lineNumber"],[110,18,69,10],[111,8,69,10,"columnNumber"],[111,20,69,10],[112,6,69,10],[112,13,70,7],[112,14,70,8],[113,4,70,8],[114,6,70,8,"fileName"],[114,14,70,8],[114,16,70,8,"_jsxFileName"],[114,28,70,8],[115,6,70,8,"lineNumber"],[115,16,70,8],[116,6,70,8,"columnNumber"],[116,18,70,8],[117,4,70,8],[117,11,71,11],[117,12,71,12],[118,2,73,0],[119,2,73,1,"_s"],[119,4,73,1],[119,5,11,24,"RootLayout"],[119,15,11,34],[120,4,11,34],[120,12,12,17,"useRouter"],[120,23,12,26],[120,24,12,26,"useRouter"],[120,33,12,26],[120,35,13,19,"usePathname"],[120,46,13,30],[120,47,13,30,"usePathname"],[120,58,13,30],[120,60,14,22,"useColorScheme"],[120,72,14,36],[120,73,14,36,"useColorScheme"],[120,87,14,36],[120,89,15,100,"useUserStore"],[120,107,15,112],[120,108,15,112,"useUserStore"],[120,120,15,112],[121,2,15,112],[122,2,15,112,"_c"],[122,4,15,112],[122,7,11,24,"RootLayout"],[122,17,11,34],[123,2,11,34],[123,6,11,34,"_c"],[123,8,11,34],[124,2,11,34,"$RefreshReg$"],[124,14,11,34],[124,15,11,34,"_c"],[124,17,11,34],[125,0,11,34],[125,3]],"functionMap":{"names":["<global>","RootLayout","useEffect$argument_0","syncEntitlement"],"mappings":"AAA;eCU;YCO;GDK;YCE;4BCI;KDiB;GDG;CDwB"},"hasCjsExports":false},"type":"js/module"}]}